本ドキュメントは、Functional Mock-up Interface（FMI）バージョン2.0.3を定義しています。これは、FMI 2.0 と比較して新機能を持たないメンテナンスリリースです。
FMIは、XMLファイルとCコード（DLL/共有ライブラリまたはソースコードにコンパイルされたもの）を組み合わせて、ダイナミックモデル（動的モデル）のモデル交換(model exchange)とコ・シミュレーション(coo-simulation)の両方をサポートする、ツールに依存しない標準規格です。
最初のバージョンであるFMI 1.0は2010年に発表されました。
FMIの開発は、ダイムラー社がサプライヤーとOEMの間でのシミュレーションモデルの交換を改善することを目的として開始しました。
現在も、多くの企業や研究機関の参加を得て、規格の開発が続けられています。
FMI 2.0は、100以上のツールでサポートされており、ヨーロッパ、アジア、北米の自動車メーカーおよび非自動車メーカーで使用されています。

ダウンロードページ（https://fmi-standard.org/downloads/）では、本仕様書のほか、サポートするC言語のヘッダーファイルやXMLスキーマファイル、FMI準拠チェックツールを提供しています。
また、ツールベンダーが他のツールとの互換性を確保するためのサンプルモデル（異なるツールからFMIフォーマットでエクスポートされたもの）や、接続されたFMU（Function Mock-up Units）がツールによって適切に処理されているかどうかをチェックするテストスイートも提供されています。

FMI開発グループ（contact@fmi-standard.org）までお問い合わせください。

_履歴 / ロードマップ_

[cols="1,1,4",options="header"]
|====
|Version
|Date
|Remarks

|1.0
|2010-01-26
|モデル交換のためのFMIの最初のバージョン

|1.0
|2010-10-12
|コ・シミュレーションのためのFMIの最初のバージョン

|2.0
|2014-07-25
|モデル交換とコ・シミュレーションのためのFMIの第2版

|2.0.1
|2019-10-31
|モデル交換とコ・シミュレーションのためのFMI 2.0のバグフィックス/メンテナンス リリース

|2.0.2
|2020-12-15
|モデル交換とコ・シミュレーションのためのFMI 2.0のバグフィックス/メンテナンス リリース

|2.0.3
|2020-12-15
|モデル交換とコ・シミュレーションのためのFMI 2.0のバグフィックス/メンテナンス リリース
|====


本仕様に関して発見された問題は、FMIの公開課題追跡システム（https://trac.fmi-standard.org）に報告してください。

*このドキュメントのライセンス*

[role=second-indented]
Copyright (C) +
2008-2011 MODELISAR consortium and +
2012-2021 Modelica Association Project "FMI"

本ドキュメントは、いかなる保証もなく「現状のまま」提供されます。
この文書は、ウィキペディアで使用されているライセンスであるCC-BY-SA（Creative Commons Attribution-Sharealike 4.0 International）ライセンスのもとに提供されています。
http://creativecommons.org/licenses/by-sa/4.0/ からのライセンステキストの人間が読める要約は以下の通りです。


[cols="1"]
|====
|You are free to

*Share* — copy and redistribute the material in any medium or format

*Remix* — remix, transform, and build upon the material for any purpose, even commercially.

The licensor cannot revoke these freedoms as long as you follow the license terms.

Under the following terms:

*Attribution* — You must give appropriate credit, provide a link to the
license, and indicate if changes were made.
You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use.

*Share Alike* — If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original.
|====

法的なライセンステキストと免責事項は、以下のサイトでご覧いただけます。

http://creativecommons.org/licenses/by-sa/4.0/legalcode

注:

[role=indented2]
本ライセンスの第3a条では、本作品の改変は、変更が加えられたことを明確に表示、区分け、またはその他の方法で示す必要があります。

[role=indented2]
この文書に添付されているC言語のヘッダーファイルとXML-schemaファイルは，BSD 2-Clauseライセンス（http://www.opensource.org/licenses/bsd-license.html）で提供されています。

[role=indented2]
この文書の一部の要素が特許権の対象となる可能性があることに注意を喚起します。
Modelica Associationは、そのような特許権を特定する責任を負いません。

[role=indented2]
改善提案がありましたら、FMI開発グループ（mailto:contact@fmi-standard.org）までお送りください。

**概要**

本ドキュメントでは、ダイナミック・システム・シミュレーション環境において、(a)ツール間でのダイナミック・モデルの交換、
(b)ツール間の結合を定義するためのFunctional Mock-up Interface (FMI), version 2.0.3を定義しています。

_モデル交換のためのFMI（第3章）_

これは、モデリング環境が、他のモデリングおよびシミュレーション環境で利用可能な、
動的システムモデルのCコード表現を生成できることを意図したものです。
モデルは、時間、状態、ステップイベントを伴う微分方程式、代数方程式、離散方程式によって記述されます。
Cコードに連続系が記述されている場合、この系は使用される環境の積分器で解かれます。
このインターフェースで扱われるモデルは、オフラインまたはオンライン・シミュレーションで使用するための大規模なものもあれば、
マイクロプロセッサ上の組み込み制御システムで使用するものもあります。

_コ・シミュレーションのためのFMI（第４章）_

その意図は、コ・シミュレーション環境におけるシミュレーション・ツールの結合のためのインターフェース規格を提供することにあります。
サブシステム間のデータ交換は、離散的な通信ポイントに制限されます。
2つの通信ポイントの間の時間では、サブシステムはそれぞれのソルバーによって互いに独立して解かれます。
マスター・アルゴリズムは、サブシステム間のデータ交換と、すべてのシミュレーション・ソルバー（スレーブ）の同期を制御します。
シンプルなマスター・アルゴリズムと、より高度なマスター・アルゴリズムの両方がサポートされています。
なお、マスター・アルゴリズム自体はFMI規格には含まれていません。

_FMIの共通概念（第２章）_

この2つのインターフェース規格には、共通する部分が多くあります。
特に、モデルやコ・シミュレーション・ツールの複数のインスタンスを利用し、それらを接続することが可能です。
また、ターゲット環境に依存するヘッダーファイルを使用していないため、ターゲット環境に依存しないインターフェースとなっています
（ターゲットプラットフォームのデータ型を除く）。
これにより、同一プラットフォーム上のどの環境でも利用可能な1つのダイナミックリンクライブラリを生成することができます。
モデル、コシミュレーション・スレーブ、ツールのカップリング部分は、FMU（Functional Mockup Unit）と呼ばれる
複数のファイルを含む1つのZIPファイルで配布されます。

. XMLファイルには、FMUで公開されているすべての変数の定義やその他の静的情報が含まれています。
この情報がなければ、ターゲットシステム上でFMUを実行することはできません。つまり、不必要なオーバーヘッドがないということです。

. 必要なモデル方程式やコ・シミュレーション・ツールへのアクセスは、使いやすいC言語の関数で提供されます。
新しいキャッシング技術により、他のアプローチよりも効率的にモデル方程式を評価することができます。
これらのC関数は、ソースまたはバイナリ形式で提供されます。
異なるプラットフォーム用のバイナリ形式は、同じFMU ZIPファイルに含めることができます。

. モデル方程式やコ・シミュレーションツールは、FMU内で直接提供することもできる。
または、モデルの評価やシミュレーションを行う外部ツールと通信する汎用通信モジュールのみをFMUに搭載することも可能です。
モデルの評価またはシミュレーションを行う外部ツールと通信する汎用通信モジュールのみを含むことができます。
XMLファイルには、FMUの機能に関する情報が含まれています。例えば、コ・シミュレーション・スレーブが、可変の通信ステップ・サイズの使用など、
高度なマスター・アルゴリズムをサポートする能力を特徴づけるために使用されます。高次信号の外挿など、
高度なマスターアルゴリズムをサポートするコ・シミュレーションスレーブの能力を示す情報が含まれています。

. FMU ZIPファイルには、特にモデルアイコン（ビットマップファイル）、ドキュメントファイル、FMUが必要とするマップやテーブル、
および/または利用されるすべてのオブジェクトライブラリやダイナミックリンクライブラリなど、さらなるデータを含めることができます。

FMIをサポートするツールは増えています。
ツールの実際のリストは、https://www.fmi-standard.org/tools でご覧いただけます。

**FMI 2.0.3について**

FMI 2.0.3は、FMI 2.0または2.0.1と比較して新しい機能の変更がないメンテナンスリリースです。+
FMI 2.0.2 に基づいて作成された FMU は、FMI 2.0 または 2.0.1 に基づいて有効な FMU です。
FMI 2.0.3 では、主に FMI3.0 の開発から得られた知見を基に、若干の明確化を行っています。

**FMI 2.0.2について**

FMI 2.0.2は、FMI 2.0または2.0.1と比較して新しい機能の変更がないメンテナンスリリースです。+
FMI 2.0.2 に従って作成された FMU は、FMI 2.0 または 2.0.1 に従って有効な FMU です。
FMI 2.0.2では、階層化された規格に従ってFMUの追加情報を提供するための標準的な場所として、「/extra」ディレクトリが導入されています。+
これは、FMUの動作を変更するものではなく、階層化された規格で要求されるなどの追加ファイル（FMUの作成後も）の保存場所を明確にするものである。

**FMI 2.0.1について**

FMI 2.0.1 はメンテナンスリリースで、FMI 2.0 と比較して新機能はありません。
FMI 2.0.1 に基づいて作成された FMU は、FMI 2.0 に基づいて有効な FMU です。

**FMI 2.0について**

FMI 2.0は、FMI 1.0を大幅に改良したもので、FMI 1.0のモデル交換およびコ・シミュレーション規格を統合し、FMI 1.0規格を使用した際の実際の経験に基づいて、多くの改善点を取り入れています。
新機能は通常、オプションです（FMUをエクスポートするツールでも、FMUをインポートするツールでもサポートする必要はない）。
詳細は付録A.3.1に記載されている。


**この文書で使用されている規約**

* Non-normative text is given in square brackets in italic font: _[Especially examples are defined in this style.]_

* Arrays appear in two forms:

** In the end-user/logical view, one- and two-dimensional arrays are used.
Here the convention of linear algebra,
the control community and the most important tools in this area is utilized.
In other words the first element along one dimension starts at index one.
In all these cases,
the starting index is also explicitly mentioned at the respective definition of the array.
For example,
in the modelDescription.xml file,
the set of exposed variables is defined as ordered sets where the first
element is referenced with index one
(these indices are, for example,
used to define the sparseness structure of partial derivative matrices).

** In the implementation view, one-dimensional C arrays are used.
In order to access an array element the C convention is used.
For example,
the first element of input argument `x` for function `setContinuousStates(..)` is `x[0]`.

** _[Clarification for FMI 2.0.2: In the structured naming convention both 0- and 1-based array indexing is allowed.]_


**FMI 2.0 Implementation Help**

If you plan to export or import models in FMI 2.0 format, you may find the following tools/models helpful for your development (available from https://fmi-standard.org/downloads):

FMU Compliance Checker:: Free software to check whether an FMI model is compliant to the FMI standard.
FMUs from other tools:: In order to test the import of FMI models from other vendors in your tool, a set of test FMUs is provided.
Library to test connected FMUs:: Free Modelica library to test difficult cases of connected FMI models.
FMU Software Development Kit:: Free software development kit by QTronic to demonstrate basic use of FMI.
FMI Library:: Free software package by Modelon that enables integration of FMI models in applications.
